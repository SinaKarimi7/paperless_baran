//
//
//

var db = require('db');
var convert_date = require('date');

function edit(income_data, cb) {

  cb = cb || function() {};

  if (!income_data._station || !income_data.date || !income_data.comment) {
    return cb({
      status: 400,
      err: new Error("low args")
    });
  }

  db.dispatch.findOne({
    _id: income_data._id
  }, function(err, dispatch) {

    var date = income_data.date.split('/');

    convert_date.to_miladi({
      year: date[0],
      month: date[1],
      day: date[2]
    }, function(d) {
      dispatch.date = d;
    });

    dispatch.comment = income_data.comment;
    dispatch._station = income_data._station;

    dispatch.save(function(err) {
      if (err) {
        return cb(err);
      }

      return cb(null, true);
    })
  })
}

module.exports = edit;
